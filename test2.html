<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style href="reset.css"/>
<style>
html {background-color: #222;}
body {width:100%;background: url("sinkingships.jpg");height: 888px;}

/* original
#move{position:absolute;left:410px;top:528px;}
*/

#move{position:absolute;left:300px;top:460px;}

.ghostship{width: 20px;box-shadow:150px 0 20px 20px #fff;position:absolute;left:110px;top:330px;}
.ghosthide {box-shadow: none;}
.originalsize img {width: 40px;}
.changesize img {width: 20px;}
#controls {position: absolute; top: 600px; left: 100px;}
#showcontrols {position: absolute; top: 600px; left: 380px; display:none;}

</style>
</head>
<body>
<p>
<!--<img src="noship.png" id="imgCanvas" class="showcontrols" onmouseover="ShowControlPanel()">-->
</p><!--Backdrop-->

<p id="move" class="originalsize"> <!--container for ship-->
	<img src="lilshipsmall.png" id="imgShip" onmouseover="ShowControlPanel()"><!--ship-->
</p>
<p id="ghostpara"></p><!--crappy ghost feature-->
<input type="button" value="Show Controls" onclick="ShowControls()" id="showcontrols"></button> <!--show controls button-->
<p id="controls"></p> <!--control panel-->

<script>

var move = document.getElementById("move"); //move is a <p>
var marginLeft = 10; // marginLeft + j === boat margin left
var j = "px";
var k = 1; // flag to stop boat
var switchCount = 0;
var sizeCount = 0;
var rate = 5; // rate of travel
var intervalId; //interval id return value is used to clear interval
var imgShip; // var for #imgShip
var shipPosition = move.style;
var ghostCount = 0;
var controls = document.getElementById("controls");
var controlsText = "";
var showControls = document.getElementById("showcontrols");
var controlsCount = 0;

//move.firstElementChild.width = 32; //sets ship width
imgShip = document.getElementById("imgShip"); //assigning reference var

function outOfBounds() {
	if (marginLeft > 320){ //console.log('out of bounds - stage right');
		StopTheBoat();
		ComeBack();	//console.log('turning around');
		MoveTheBoat(); //console.log('coming back');
	}
	if (marginLeft < -360){ //console.log('out of bounds - stage left');
		StopTheBoat();
		ComeBack(); //console.log('turning around');
		MoveTheBoat(); //console.log('coming back');
	}
}
function MoveIt(){ // this function is a parameter of movetheboat()
	shipPosition.marginLeft = marginLeft + j; //margin left moves the <p> holding the boat. At start: marginLeft=10, j="px"
	if (k > 0) {
		marginLeft += rate; // assignment statement updates margin position. At start: k=1, l=0, marginLeft=10, rate=5. This line initializes marginLeft to 6 [1*(5+(1+0))]. k multiplication stops the boat if set to 0 and resumes if set to 1. //console.log(marginLeft); //writes position to log. At start marginLeft=10
		outOfBounds();
	}
}
function MoveTheBoat(){
	intervalId = setInterval(MoveIt, 100);
	k = 1; //reset ship stop flag
}
function StopTheBoat(){
	k = 0; // stop boat
	clearInterval(intervalId); //interval id return value is used to clear interval
}
function ComeBack(){
	switchCount += 1; //counts switches to determine ship facing
	if (switchCount % 2 === 1) { //1 means ship is facing right
		//imgShip.src = imgShip.src.replace("lilship.png", "lilshipleft.png"); //switches right-facing ship pic to left-facing ship //console.log("switch to left");
		imgShip.src = imgShip.src.replace("lilshipsma.png", "lilshipleftsma.png"); //switches right-facing ship pic to left-facing ship //console.log("switch to left");
		rate *= (-1);
	}
	else if (switchCount % 2 === 0) { //0 means ship is facing left
		imgShip.src = imgShip.src.replace("lilshipleftsma.png", "lilshipsma.png"); //switches left-facing ship pic to right-facing ship //console.log("switch to right");
		rate *= (-1);
	}
	else {
		console.log("no switch"); //catch error
	}	
}
function GhostShip(){
	ghostCount +=1;
	if (ghostCount % 2 === 1) { //initial, second click
		document.getElementById("ghostpara").className = "ghostship";
	}
	if (ghostCount % 2 === 0) { //first click
		document.getElementById("ghostpara").className = "ghosthide";
	}
}
function ChangeSize() {
	sizeCount += 1;
	if (sizeCount % 2 === 1) {
		document.getElementById("move").className = "changesize"; //move.firstElementChild.width = 8;// console.log("shrinky size!");
	} else if (sizeCount % 2 === 0) {
		document.getElementById("move").className = "originalsize"; //move.firstElementChild.width = 32; // console.log("regular size!");
	} else {
		console.log("no change in size"); //catch error
	}
}
function ShowControls() {
	controlsText += '<input type="button" value="Move that Boat!" onclick="MoveTheBoat()"></button>';
	controlsText += '<input type="button" value="Stop!" onclick="StopTheBoat()"></button>';
	controlsText += '<input type="button" value="Change Direction!" onclick="ComeBack()"></button>';
	controlsText += '<input type="button" value="Ghost Ship?" onclick="GhostShip()"></button>';
	controlsText += '<input type="button" value="Change Size!" onclick="ChangeSize()"></button>';
	controls.innerHTML += controlsText;
	document.getElementById("showcontrols").style.display = "none";
}
function ShowControlPanel () {
	controlsCount += 1;
	if (controlsCount <= 1) {
		showControls.style.display = "block";
	}
}

//issues:
//rate is 5 at first
//multiple move presses increases rate
//after stopping, rate stays high

//to do:
// build pop out control panel

</script>

<!--
<input type="button" value="Move that Boat!" onclick="MoveTheBoat()"></button>
<input type="button" value="Stop!" onclick="StopTheBoat()"></button>
<input type="button" value="Change Direction!" onclick="ComeBack()"></button>
<input type="button" value="Ghost Ship?" onclick="GhostShip()"></button>
<input type="button" value="Change Size!" onclick="ChangeSize()"></button>
-->
</body>
</html>